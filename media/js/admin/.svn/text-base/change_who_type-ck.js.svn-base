function change_who_type(){}change_who_type.prototype={show_filter:"all",page:1,show_filter_container:null,tbody:null,tfoot_td:null,colspan:0,is_saving:!1,$paging_text:null,init:function(){this.binds();this.refreshReports()},binds:function(){var e=this;$("input[name=show_filter]").click(function(t){e.show_filter=t.target.value;e.refreshReports()});e.show_filter_container=$("#show_filter_container");e.tbody=$("#change_who_type_table tbody");e.tfoot_td=$("#change_who_type_table tfoot td");e.$paging_text=$("#paging_text");e.colspan=e.tfoot_td.attr("colspan");$(".who-type-radio").live("change",function(t){var n=$(this).attr("data-report_id"),r=t.target.value;e.saveReport(n,r)});$(".paging-item").live("click",function(){var t=$(this).attr("data-page");e.page=t;e.refreshReports()});$("#new_who_type_bulk_save").click(function(){var t=$("select[name='new_who_type']").val();e.bulkChangeWhoType(t)})},refreshReports:function(){var e=this;e.$paging_text.html("Loading...");e.tbody.html('<tr><td colspan="'+e.colspan+'"><div class="loader"></div></td></tr>');e.tfoot_td.html("");var t=$sb.ajax;t.async=!1;t.get("/admin/change_who_type",{show_filter:e.show_filter,page:e.page},function(t){e.tbody.html(t.html);e.tfoot_td.html(t.data.pagination);e.$paging_text.html(t.data.paging_text)})},saveReport:function(e,t){var n=this;n.is_saving=!0;n.show_filter_container.find("*").attr("disabled",!0);var r=$("#radio_container_"+e);r.find("*").attr("disabled",!0);var i=$("#status_message_"+e);i.html("Saving...");var s=$sb.ajax;s.async=!1;var o=$("#new_who_type_bulk_save");o.attr("disabled",!0);s.post("/admin/save_who_type",{report_id:e,new_who_type_id:t},function(e){n.show_filter_container.find("*").removeAttr("disabled");r.find("*").removeAttr("disabled");i.html("");o.attr("disabled",!1);n.is_saving=!1})},bulkChangeWhoType:function(e){var t=this,n=[];$(".who-type-radio:checked").each(function(){$(this).removeAttr("checked")});$("input.who-type-radio[value='"+e+"']").each(function(){$(this).attr("checked","checked");var e={};e.id=$(this).data("report_id");n.push(e)});t.saveReports(n,e)},saveReports:function(e,t){var n=this;n.is_saving=!0;n.show_filter_container.find("*").attr("disabled",!0);var r=$("#new_who_type_bulk_save");r.attr("disabled",!0);var i=$("[id^=radio_container]");i.find("*").attr("disabled",!0);var s=$(".status-message");s.html("Saving...");var o=$sb.ajax;o.async=!1;o.post("/admin/batch_save_who_type",{reports:e,who_type_id:t},function(e){n.show_filter_container.find("*").removeAttr("disabled");i.find("*").removeAttr("disabled");s.html("");r.attr("disabled",!1);n.is_saving=!1})}};$(document).ready(function(){$sb.change_who_type=new change_who_type;$sb.change_who_type.init()});